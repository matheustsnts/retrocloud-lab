<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>RetroCloud Lab</title>
    
    <link rel="stylesheet" href="css/libs/bootstrap.min.css">
    
    <style>
        body { background-color: #2c3e50; color: #ecf0f1; }
        .navbar-brand { font-weight: bold; }
        .container { margin-top: 30px; }
        #emulator-screen {
            width: 100%;
            max-width: 640px;
            height: 480px;
            background: #000;
            border: 2px solid #34495e;
            margin: 20px auto;
            display: block;
            border-radius: 5px;
        }
        #game-canvas { width: 100%; height: 100%; }
        .list-group-item {
            background-color: #34495e;
            border-color: #2c3e50;
            color: #ecf0f1;
            transition: all 0.2s;
        }
        .list-group-item:hover {
            background-color: #4a6582;
            cursor: pointer;
        }
        .card-header { background-color: #34495e; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="#">RetroCloud Lab</a>
    </nav>

    <div class="container text-center">
        <h1 class="mb-4">Meu Arcade Pessoal</h1>
        
        <div id="emulator-screen">
            <canvas id="game-canvas"></canvas>
        </div>

        <div class="row mt-4 justify-content-center">
            <div class="col-md-4 mb-3">
                <div class="card bg-dark text-white">
                    <h5 class="card-header">SNES</h5>
                    <div class="list-group list-group-flush">
                        <button type="button" class="list-group-item" 
                                onclick="loadGame('snes', 'roms/snes/mario.smc')">
                            Super Mario World (coloque 'mario.smc')
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-3">
                <div class="card bg-dark text-white">
                    <h5 class="card-header">Nintendo 64</h5>
                    <div class="list-group list-group-flush">
                        <button type="button" class="list-group-item" 
                                onclick="loadGame('n64', 'roms/n64/mario.n64')">
                            Mario 64 (coloque 'mario.n64')
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4 mb-3">
                <div class="card bg-dark text-white">
                    <h5 class="card-header">PlayStation 1</h5>
                    <div class="list-group list-group-flush">
                        <button type="button" class="list-group-item" 
                                onclick="loadGame('psx', 'roms/ps1/crash.chd')">
                            Crash (coloque 'crash.chd')
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
    </div>

    <script src="js/libs/jquery.min.js"></script>
    <script src="js/libs/bootstrap.bundle.min.js"></script>
    
    <script src="js/emulator/utils.js"></script>
    <script src="js/emulator/emulator.js"></script>
    
    <script>
        // 1. Configurações globais do EmulatorJS
        window.EJS_paths = {
            'core': 'colors/', // Onde estão os .wasm
            'rom': 'roms/',    // Pasta raiz das ROMs
            'game': 'roms/'
        };
        
        // 2. Mapeamento de "cores" (ajuste os nomes dos .wasm se forem diferentes)
        window.EJS_cores = {
            'snes': 'snes9x_libretro.wasm',
            'n64': 'mupen64plus_next_libretro.wasm',
            'psx': 'pcsx_rearmed_libretro.wasm'
        };

        // 3. Função para carregar o jogo
        function loadGame(coreName, romPath) {
            console.log(`Carregando: ${coreName} com a ROM ${romPath}`);
            
            const core = EJS_cores[coreName];
            const canvas = document.getElementById('game-canvas');
            
            if (!core) {
                alert('Core (emulador) não definido para: ' + coreName);
                return;
            }

            try {
                const emu = new EmuJS(canvas, romPath, core);
                emu.start();
            } catch (e) {
                console.error(e);
                alert('Erro ao iniciar emulador. Verifique o console (F12) e o README.');
            }
        }

        .ready(function() {
            console.log('RetroCloud Lab carregado! Pronto para receber comandos.');
            console.log('Lembre-se: Baixe o EmulatorJS e suas ROMs.');
        });
    </script>

</body>
</html>
